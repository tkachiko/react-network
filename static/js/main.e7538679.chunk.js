(this["webpackJsonpsocial-network"]=this["webpackJsonpsocial-network"]||[]).push([[0],{107:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(2),s=n(3),a=n(4),c=n(8),i=n(9),o=n(1),u=n.n(o),l=n(14),j=n(10),b=n(0),d=function(e){return{isAuth:e.auth.isAuth}},p=function(e){var t=function(t){Object(c.a)(o,t);var n=Object(i.a)(o);function o(){return Object(s.a)(this,o),n.apply(this,arguments)}return Object(a.a)(o,[{key:"render",value:function(){return this.props.isAuth?Object(b.jsx)(e,Object(r.a)({},this.props)):Object(b.jsx)(j.a,{to:"/login"})}}]),o}(u.a.Component);return Object(l.b)(d)(t)}},108:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(16),s=n(2),a="dialogs/SEND-MESSAGE",c={dialogs:[{id:1,name:"Emmett"},{id:2,name:"Marty"},{id:3,name:"Lorraine"},{id:4,name:"George"},{id:5,name:"Jennifer"},{id:6,name:"Einstein"}],messages:[{id:1,message:"Great Scott!"},{id:2,message:"Nobody calls me chicken!"},{id:3,message:"No way!"},{id:4,message:"How's it going?"},{id:5,message:"Maybe later"},{id:6,message:"Woof!"}]},i=function(e){return{type:a,text:e}};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a:return Object(s.a)(Object(s.a)({},e),{},{messages:[].concat(Object(r.a)(e.messages),[{id:e.messages.length+1,message:t.text}])});default:return e}}},11:function(e,t,n){e.exports={nav:"Navbar_nav__2imOE",list:"Navbar_list__2GzPV",listItem:"Navbar_listItem__3fvzT"}},127:function(e,t,n){},249:function(e,t,n){},250:function(e,t,n){},251:function(e,t,n){},252:function(e,t,n){},253:function(e,t,n){"use strict";n.r(t);var r=n(1),s=n.n(r),a=n(53),c=n.n(a),i=n(3),o=n(4),u=n(8),l=n(9),j=n(14),b=n(10),d=n(17),p=n(25),f=(n(127),n.p+"static/media/preloader.934e3b5f.svg"),h=n(0),O=function(){return Object(h.jsx)("div",{children:Object(h.jsx)("img",{src:f})})},g=n(2),m=n(5),x=n.n(m),v=n(19),_=n(110),P=n.n(_).a.create({withCredentials:!0,baseURL:"https://social-network.samuraijs.com/api/1.0/",headers:{"API-KEY":"38489ffb-786b-4236-a167-fe8283151742"}}),w={getUsers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return P.get("users/?page=".concat(e,"&count=").concat(t))},follow:function(e){return P.post("follow/".concat(e))},unfollow:function(e){return P.delete("follow/".concat(e))}},S=function(e){return P.get("profile/".concat(e))},y=function(e){return P.get("profile/status/".concat(e))},k=function(e){return P.put("profile/status",{status:e})},N=function(e){var t=new FormData;return t.append("image",e),P.put("profile/photo",t,{headers:{"Content-Type":"multipart/form-data"}})},C=function(e){return P.put("profile",e)},I=function(){return P.get("auth/me/")},E=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return P.post("auth/login",{email:e,password:t,rememberMe:n,captcha:r})},F=function(){return P.delete("auth/login")},U=function(){return P.get("security/get-captcha-url")},T="auth/SET_USER_DATA",A="auth/STOP_SUBMIT",M="auth/GET_CAPTCHA_URL_SUCCESS",L={userId:null,email:null,login:null,isAuth:!1,error:null,captchaUrl:null},D=function(e,t,n,r){return{type:T,payload:{userId:e,login:t,email:n,isAuth:r}}},z=function(e){return{type:A,error:e}},R=function(e){return{type:M,payload:{captchaUrl:e}}},J=function(){return function(){var e=Object(v.a)(x.a.mark((function e(t){var n,r,s,a,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:0===(n=e.sent).data.resultCode&&(r=n.data.data,s=r.id,a=r.login,c=r.email,t(D(s,a,c,!0)));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},B=function(){return function(){var e=Object(v.a)(x.a.mark((function e(t){var n,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U();case 2:n=e.sent,r=n.data.url,t(R(r));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:case M:return Object(g.a)(Object(g.a)({},e),t.payload);case A:return Object(g.a)(Object(g.a)({},e),{},{error:t.error});default:return e}},V=n.p+"static/media/logo.193e50e3.svg",W=n(45),q=n.n(W),H=function(e){var t=e.isAuth,n=e.login,r=e.logout;return Object(h.jsxs)("header",{className:q.a.header,children:[Object(h.jsx)("img",{src:V,className:q.a.logo,alt:"logo"}),Object(h.jsx)("div",{className:q.a.loginBlock,children:t?Object(h.jsxs)("div",{children:[n," -"," ",Object(h.jsx)("button",{onClick:r,className:q.a.button,children:"Sign out"})," "]}):Object(h.jsx)(d.b,{to:"/login",children:"Sign in"})})]})},Y=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(h.jsx)(H,Object(g.a)({},this.props))}}]),n}(s.a.Component),X=Object(j.b)((function(e){return{isAuth:e.auth.isAuth,login:e.auth.login}}),{logout:function(){return function(){var e=Object(v.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F();case 2:0===e.sent.data.resultCode&&t(D(L));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})(Y),K=n(15),Z=n(61),Q=n(13),$=n(59),ee=["children"],te=function(e){var t=e.children,n=Object($.a)(e,ee),r=Object(K.d)(Object(g.a)(Object(g.a)({},n),{},{type:"checkbox"})),s=Object(Q.a)(r,2),a=s[0],c=s[1];return Object(h.jsxs)("div",{children:[Object(h.jsxs)("label",{className:"checkbox-input",children:[Object(h.jsx)("input",Object(g.a)(Object(g.a)({type:"checkbox"},a),n)),t]}),c.touched&&c.error?Object(h.jsx)("div",{className:"error",children:c.error}):null]})},ne=n(60),re=n.n(ne),se=["label"],ae=function(e){var t=e.label,n=Object($.a)(e,se),r=Object(K.d)(n),s=Object(Q.a)(r,2),a=s[0],c=s[1];return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("label",{htmlFor:n.id||n.name,children:t}),Object(h.jsx)(K.a,Object(g.a)(Object(g.a)({className:c.touched&&c.error?"".concat(re.a.inputError):"".concat(re.a.textInput)},a),n)),c.touched&&c.error?Object(h.jsx)("span",{className:re.a.error,children:c.error}):null]})},ce=n(44),ie=n.n(ce),oe=function(e){var t=e.captchaUrl,n=e.error,r=e.status;return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)(K.b,{children:[Object(h.jsx)(ae,{label:"Email",name:"email",type:"email",placeholder:"jane@formik.com"}),Object(h.jsx)(ae,{label:"Password",name:"password",type:"password",placeholder:"Password"}),Object(h.jsx)(te,{name:"rememberMe",children:"Remember me"}),Object(h.jsx)("div",{className:ie.a.captcha,children:t&&Object(h.jsx)("img",{src:t,alt:""})}),Object(h.jsx)("div",{children:t&&Object(h.jsx)(ae,{type:"text",name:"captcha",placeholder:"Enter captcha"})}),Object(h.jsxs)("div",{className:ie.a.formSummaryError,children:[r,n]}),Object(h.jsx)("button",{type:"submit",children:"Sign in"})]})})},ue=Object(j.b)((function(e){return{captchaUrl:e.auth.captchaUrl,error:e.auth.error,isAuth:e.auth.isAuth}}),{login:function(e,t,n,r,s){return function(){var a=Object(v.a)(x.a.mark((function a(c){var i,o;return x.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,E(e,t,n,r);case 2:0===(i=a.sent).data.resultCode?(c(J()),console.log("Logged in successfully!")):(10===i.data.resultCode&&c(B()),o=i.data.messages.length>0?i.data.messages[0]:"Some error",c(z(o)),s(i.data.messages),console.log("An error has occured"));case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}})((function(e){var t=e.isAuth,n=e.captchaUrl,r=e.error,s=e.login;return t?Object(h.jsx)(b.a,{to:"/profile"}):Object(h.jsxs)("div",{className:ie.a.loginForm,children:[Object(h.jsx)("h1",{children:"Sign in"}),Object(h.jsx)(K.c,{initialValues:{email:"",password:"",rememberMe:!1,captcha:""},validationSchema:Z.a({email:Z.b().required("Required"),password:Z.b().required("Required")}),onSubmit:function(e,t){var n=t.setSubmitting,r=t.setFieldError,a=t.setStatus;s(e.email,e.password,e.rememberMe,e.captcha,n,r,a),console.log("Logging in as",e.email),n(!1)},children:function(e){var t=e.isSubmitting,s=e.status;return Object(h.jsx)(oe,{captchaUrl:n,error:r,isSubmitting:t,status:s})}})]})})),le=(n(249),function(){return Object(h.jsx)("div",{children:"Music"})}),je=n(11),be=n.n(je),de=function(){return Object(h.jsx)("nav",{className:be.a.nav,children:Object(h.jsxs)("ul",{className:be.a.list,children:[Object(h.jsx)("li",{className:be.a.listItem,children:Object(h.jsx)(d.b,{to:"/profile",className:be.a.link,activeClassName:be.a.active,children:"Profile"})}),Object(h.jsx)("li",{className:be.a.listItem,children:Object(h.jsx)(d.b,{to:"/dialogs",className:be.a.link,activeClassName:be.a.active,children:"Messages"})}),Object(h.jsx)("li",{className:be.a.listItem,children:Object(h.jsx)(d.b,{to:"/news",className:be.a.link,activeClassName:be.a.active,children:"News"})}),Object(h.jsx)("li",{className:be.a.listItem,children:Object(h.jsx)(d.b,{to:"/music",className:be.a.link,activeClassName:be.a.active,children:"Music"})}),Object(h.jsx)("li",{className:be.a.listItem,children:Object(h.jsx)(d.b,{to:"/users",className:be.a.link,activeClassName:be.a.active,children:"Users"})}),Object(h.jsx)("li",{className:be.a.listItem,children:Object(h.jsx)(d.b,{to:"/settings",className:be.a.link,activeClassName:be.a.active,children:"Settings"})})]})})},pe=(n(250),function(){return Object(h.jsx)("div",{children:"News"})}),fe=n(16),he="profile/ADD_POST",Oe="profile/SET_USER_PROFILE_NEW_POST_TEXT",ge="profile/SET_STATUS",me="profile/DELETE_POST",xe="profile/SET_PHOTO",ve="SAVE_PROFILE_SUCCESS",_e="STOP_SUBMIT",Pe={posts:[{id:1,message:"Hi how are you?",likesCount:7},{id:2,message:"It's my first post!",likesCount:15}],profile:null,name:null,status:"",error:null},we=function(e){return{type:ge,status:e}},Se=function(e){return{type:_e,error:e}},ye=function(e){return function(){var t=Object(v.a)(x.a.mark((function t(n){var r;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S(e);case 2:r=t.sent,n((s=r.data,{type:Oe,profile:s}));case 4:case"end":return t.stop()}var s}),t)})));return function(e){return t.apply(this,arguments)}}()},ke=function(e,t){return function(){var n=Object(v.a)(x.a.mark((function n(r,s){var a,c,i;return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=s().auth.userId,n.next=3,C(e);case 3:0===(c=n.sent).data.resultCode?(r(ye(a)),t(!1)):(i=c.data.messages.length>0?c.data.messages[0]:"Some error",r(Se(i)),t(!0));case 5:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()},Ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he:return Object(g.a)(Object(g.a)({},e),{},{posts:[].concat(Object(fe.a)(e.posts),[{id:e.posts.length+1,message:t.text}])});case me:return Object(g.a)(Object(g.a)({},e),{},{posts:e.posts.filter((function(e){return e.id!==t.postId}))});case ge:return Object(g.a)(Object(g.a)({},e),{},{status:t.status});case xe:return Object(g.a)(Object(g.a)({},e),{},{profile:Object(g.a)(Object(g.a)({},e.profile),{},{photos:t.photos})});case Oe:case ve:return Object(g.a)(Object(g.a)({},e),{},{profile:t.profile});case _e:return Object(g.a)(Object(g.a)({},e),{},{error:t.error});default:return e}},Ce=n(46),Ie=n.n(Ce),Ee=n(75),Fe=n.n(Ee),Ue=function(e){var t=e.message,n=e.likesCount;return Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{className:Fe.a.item,children:[Object(h.jsx)("img",{src:"https://avatarfiles.alphacoders.com/253/thumb-253458.jpg",alt:"avatar"}),Object(h.jsx)("span",{className:Fe.a.post,children:t})]}),Object(h.jsx)("div",{children:Object(h.jsxs)("span",{children:["Like ",n]})})]})},Te=function(e){var t=e.posts,n=e.addPost,r=t.map((function(e){return Object(h.jsx)(Ue,{message:e.message,likesCount:e.likesCount,id:e.id},e.id)})).reverse();return Object(h.jsxs)("div",{className:Ie.a.posts,children:[Object(h.jsx)("div",{children:Object(h.jsx)(K.c,{initialValues:{post:""},onSubmit:function(e,t){var r=t.setSubmitting,s=t.resetForm;n(e.post),s({values:""}),r(!1)},children:function(e){var t=e.values,n=e.handleChange,r=e.handleSubmit;return Object(h.jsxs)(K.b,{children:[Object(h.jsx)("div",{children:Object(h.jsx)("textarea",{name:"post",onChange:n,value:t.post,placeholder:"What's on your mind?",className:Ie.a.textarea})}),Object(h.jsx)("div",{className:Ie.a.buttonWrapper,children:Object(h.jsx)("input",{onSubmit:r,type:"submit",value:"Send"})})]})}})}),Object(h.jsx)("div",{className:Ie.a.item,children:r})]})},Ae=Object(j.b)((function(e){return{posts:e.profilePage.posts,newPostText:e.profilePage.newPostText}}),(function(e){return{addPost:function(t){e(function(e){return{type:he,text:e}}(t))}}}))(Te),Me=n(76),Le=n.n(Me),De=n.p+"static/media/user.664bc0bf.png",ze=function(e){var t=Object(r.useState)(!1),n=Object(Q.a)(t,2),s=n[0],a=n[1],c=Object(r.useState)(e.status),i=Object(Q.a)(c,2),o=i[0],u=i[1];Object(r.useEffect)((function(){u(e.status)}),[e.status]);return Object(h.jsxs)("div",{children:[!s&&Object(h.jsx)("div",{children:Object(h.jsxs)("span",{onDoubleClick:function(){a(!0)},children:[Object(h.jsx)("b",{children:"Status: "}),e.status||"---------"]})}),s&&Object(h.jsx)("div",{children:Object(h.jsx)("input",{onChange:function(e){u(e.target.value)},autoFocus:!0,onBlur:function(){a(!1),e.updateStatus(o)},value:o})})]})},Re=n(26),Je=n.n(Re),Be=function(e){var t=e.contactTitle,n=e.contactValue;return Object(h.jsxs)("li",{className:Je.a.contacts__item,children:[Object(h.jsxs)("h5",{children:[t,": "]}),Object(h.jsx)("span",{children:n})]})},Ge=function(e){var t=e.profile,n=e.isOwner,r=e.activateEditMode;return Object(h.jsxs)("div",{className:Je.a.ProfileInfo,children:[n&&Object(h.jsx)("div",{children:Object(h.jsx)("button",{onClick:r,children:"edit"})}),Object(h.jsx)("h5",{className:Je.a.heading,children:"Full name: "}),t.fullName,Object(h.jsxs)("ul",{children:[Object(h.jsxs)("li",{children:[Object(h.jsx)("h5",{className:Je.a.heading,children:"Looking for a job: "}),t.lookingForAJob?"yes":"no"]}),t.lookingForAJob&&Object(h.jsxs)("li",{children:[Object(h.jsx)("h5",{className:Je.a.heading,children:"My professional skills: "}),t.lookingForAJobDescription]}),Object(h.jsxs)("li",{children:[Object(h.jsx)("h5",{className:Je.a.heading,children:"About me: "}),t.aboutMe]}),Object(h.jsxs)("ul",{children:[Object(h.jsx)("h5",{children:"Contacts:"}),Object.keys(t.contacts).map((function(e){return Object(h.jsx)(Be,{contactTitle:e,contactValue:t.contacts[e]},e)}))]})]})]})},Ve=function(e){var t=Object.assign({},e),n=Object(K.d)(t),r=Object(Q.a)(n,1)[0];return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{children:Object(h.jsx)("textarea",Object(g.a)(Object(g.a)({},r),t))})})},We=Object(j.b)((function(e){return{error:e.profilePage.error}}),{saveProfile:ke})((function(e){var t=e.profile,n=e.setEditMode,r=e.error,s=e.saveProfile,a=e.isSubmitting;return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(K.c,{initialValues:{fullName:t.fullName,lookingForAJob:t.lookingForAJob,lookingForAJobDescription:t.lookingForAJobDescription,aboutMe:t.aboutMe,contacts:{facebook:t.contacts.facebook,website:t.contacts.website,vk:t.contacts.vk,twitter:t.contacts.twitter,instagram:t.contacts.instagram,youtube:t.contacts.youtube,github:t.contacts.github,mainLink:t.contacts.mainLink}},onSubmit:function(e,t){var r=t.setSubmitting;s(e,n),r(!1)},children:Object(h.jsxs)(K.b,{children:[Object(h.jsx)("div",{children:Object(h.jsx)("button",{type:"submit",disabled:a,children:"save"})}),r&&Object(h.jsx)("div",{className:Je.a.formSummaryError,children:r}),Object(h.jsxs)("div",{children:[Object(h.jsx)("b",{children:"Full Name:"}),Object(h.jsx)(ae,{type:"text",name:"fullName",placeholder:"Full Name"})]}),Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("b",{children:"Looking for a job: "}),Object(h.jsx)(te,{name:"lookingForAJob"})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("b",{children:"My professional skills: "}),Object(h.jsx)(Ve,{type:"text",name:"lookingForAJobDescription",placeholder:"My professional skills"})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("b",{children:"About me: "}),Object(h.jsx)(ae,{type:"text",name:"aboutMe",placeholder:"Tell about yourself"})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("b",{children:"Contacts:"}),Object.keys(t.contacts).map((function(e){return Object(h.jsx)("div",{className:Je.a.contact,children:Object(h.jsxs)("b",{children:[e,Object(h.jsx)(ae,{type:"text",name:"contacts."+e,placeholder:e})]})},e)}))]})]})]})})})})),qe=function(e){var t=e.profile,n=e.status,s=e.updateStatus,a=e.isOwner,c=e.updatePhoto,i=e.error,o=Object(r.useState)(!1),u=Object(Q.a)(o,2),l=u[0],j=u[1];if(!t)return Object(h.jsx)(O,{});return Object(h.jsx)("div",{children:Object(h.jsxs)("div",{className:Le.a.descriptionBlock,children:[Object(h.jsx)("img",{src:null!==t.photos.large?t.photos.large:De,className:Le.a.userPhoto,alt:"user avatar"}),a&&Object(h.jsx)("input",{type:"file",onChange:function(e){e.target.files.length&&c(e.target.files[0])}}),Object(h.jsx)(ze,{status:n,updateStatus:s}),l?Object(h.jsx)(We,{profile:t,error:i,setEditMode:j}):Object(h.jsx)(Ge,{profile:t,isOwner:a,activateEditMode:function(){j(!0)}})]})})},He=function(e){var t=e.profile,n=e.status,r=e.updateStatus,s=e.isOwner,a=e.updatePhoto,c=e.saveProfile;return Object(h.jsxs)("main",{children:[Object(h.jsx)(qe,{profile:t,status:n,updateStatus:r,isOwner:s,updatePhoto:a,saveProfile:c}),Object(h.jsx)(Ae,{})]})},Ye=n(107),Xe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"refreshProfile",value:function(){var e=this.props.match.params.userId;e||(e=this.props.authorizedUserId)||this.props.history.push("/login"),this.props.getUserProfile(e),this.props.getStatus(e)}},{key:"componentDidMount",value:function(){this.refreshProfile()}},{key:"componentDidUpdate",value:function(e,t,n){this.props.match.params.userId!==e.match.params.userId&&this.refreshProfile()}},{key:"render",value:function(){return Object(h.jsx)(He,Object(g.a)(Object(g.a)({},this.props),{},{isOwner:!this.props.match.params.userId,updatePhoto:this.props.updatePhoto,saveProfile:this.props.saveProfile}))}}]),n}(s.a.Component),Ke=Object(p.c)(Object(j.b)((function(e){return{profile:e.profilePage.profile,status:e.profilePage.status,authorizedUserId:e.auth.userId,isAuth:e.auth.isAuth}}),{getUserProfile:ye,getStatus:function(e){return function(){var t=Object(v.a)(x.a.mark((function t(n){var r;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y(e);case 2:r=t.sent,n(we(r.data));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},updateStatus:function(e){return function(){var t=Object(v.a)(x.a.mark((function t(n){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k(e);case 2:0===t.sent.data.resultCode&&n(we(e));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},updatePhoto:function(e){return function(){var t=Object(v.a)(x.a.mark((function t(n){var r;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N(e);case 2:0===(r=t.sent).data.resultCode&&n((s=r.data.data.photos,{type:xe,photos:s}));case 4:case"end":return t.stop()}var s}),t)})));return function(e){return t.apply(this,arguments)}}()},saveProfile:ke}),b.g,Ye.a)(Xe),Ze=(n(251),function(){return Object(h.jsx)("div",{children:"Settings"})}),Qe="users/FOLLOW",$e="users/UNFOLLOW",et="users/SET_USERS",tt="users/SET_CURRENT_PAGE",nt="users/SET_TOTAL_USERS_COUNT",rt="users/TOGGLE_IS_FETCHING",st="users/TOGGLE_IS_FOLLOWING_PROGRESS",at={users:[],pageSize:10,totalUsersCount:0,currentPage:1,isFetching:!1,followingInProgress:[]},ct=function(e){return{type:Qe,userID:e}},it=function(e){return{type:$e,userID:e}},ot=function(e){return{type:tt,currentPage:e}},ut=function(e){return{type:rt,isFetching:e}},lt=function(e,t){return{type:st,isFetching:e,userID:t}},jt=function(){var e=Object(v.a)(x.a.mark((function e(t,n,r,s){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(lt(!0,n)),e.next=3,r(n);case 3:0===e.sent.data.resultCode&&t(s(n)),t(lt(!1,n));case 6:case"end":return e.stop()}}),e)})));return function(t,n,r,s){return e.apply(this,arguments)}}(),bt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:at,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Qe:return Object(g.a)(Object(g.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userID?Object(g.a)(Object(g.a)({},e),{},{followed:!0}):e}))});case $e:return Object(g.a)(Object(g.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userID?Object(g.a)(Object(g.a)({},e),{},{followed:!1}):e}))});case et:return Object(g.a)(Object(g.a)({},e),{},{users:t.users});case tt:return Object(g.a)(Object(g.a)({},e),{},{currentPage:t.currentPage});case nt:return Object(g.a)(Object(g.a)({},e),{},{totalUsersCount:t.count});case rt:return Object(g.a)(Object(g.a)({},e),{},{isFetching:t.isFetching});case st:return Object(g.a)(Object(g.a)({},e),{},{followingInProgress:t.isFetching?[].concat(Object(fe.a)(e.followingInProgress),[t.userID]):e.followingInProgress.filter((function(e){return e!==t.userID}))});default:return e}},dt=n(116),pt=Object(dt.a)((function(e){return e.usersPage.users}),(function(e){return e.filter((function(e){return!0}))})),ft=function(e){return e.usersPage.pageSize},ht=function(e){return e.usersPage.totalUsersCount},Ot=function(e){return e.usersPage.currentPage},gt=function(e){return e.usersPage.isFetching},mt=function(e){return e.usersPage.followingInProgress},xt=n(29),vt=n.n(xt),_t=n(39),Pt=n.n(_t),wt=function(e){for(var t=e.totalItemsCount,n=e.pageSize,s=e.currentPage,a=e.onPageChanged,c=e.portionSize,i=void 0===c?10:c,o=Math.ceil(t/n),u=[],l=1;l<=o;l++)u.push(l);var j=Math.ceil(o/i),b=Object(r.useState)(Math.ceil(s/i)),d=Object(Q.a)(b,2),p=d[0],f=d[1],O=(p-1)*i+1,g=p*i;return Object(r.useEffect)((function(){return f(Math.ceil(s/i))}),[s]),Object(h.jsxs)("div",{className:Pt.a.paginator,children:[p>1&&Object(h.jsx)("button",{className:Pt.a.button,onClick:function(){f(p-1)},children:"PREV"}),u.filter((function(e){return e>=O&&e<=g})).map((function(e){return Object(h.jsx)("span",{className:"".concat(Pt.a.page," ").concat(s===e&&Pt.a.selectedPage),onClick:function(){a(e)},children:e},e)})),j>p&&Object(h.jsx)("button",{className:Pt.a.button,onClick:function(){f(p+1)},children:"NEXT"})]})},St=function(e){var t=e.user,n=e.followingInProgress,r=e.follow,s=e.unfollow;return Object(h.jsx)("div",{className:vt.a.usersPage,children:Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{children:Object(h.jsx)(d.b,{to:"/profile/".concat(t.id),children:Object(h.jsx)("img",{src:null!==t.photos.small?t.photos.small:De,alt:"user avatar",className:vt.a.userPhoto})})}),Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{children:t.name}),Object(h.jsx)("div",{children:t.status})]}),Object(h.jsx)("div",{children:t.followed?Object(h.jsx)("button",{className:vt.a.button,disabled:n.some((function(e){return e===t.id})),onClick:function(){s(t.id)},children:"Unfollow"}):Object(h.jsx)("button",{className:vt.a.button,disabled:n.some((function(e){return e===t.id})),onClick:function(){r(t.id)},children:"Follow"})})]})})},yt=function(e){var t=e.totalUsersCount,n=e.pageSize,r=e.currentPage,s=e.onPageChanged,a=e.users,c=e.followingInProgress,i=e.follow,o=e.unfollow;return Object(h.jsxs)("div",{className:vt.a.usersPage,children:[Object(h.jsx)(wt,{totalItemsCount:t,pageSize:n,currentPage:r,onPageChanged:s}),Object(h.jsx)("ul",{className:vt.a.usersList,children:a.map((function(e){return Object(h.jsx)("li",{className:vt.a.user,children:Object(h.jsx)(St,{user:e,followingInProgress:c,follow:i,unfollow:o},e.id)})}))})]})},kt=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).onPageChanged=function(t){e.props.requestUsers(t,e.props.pageSize)},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.requestUsers(this.props.currentPage,this.props.pageSize)}},{key:"render",value:function(){return Object(h.jsx)(h.Fragment,{children:this.props.isFetching?Object(h.jsx)(O,{}):Object(h.jsx)(yt,{totalUsersCount:this.props.totalUsersCount,pageSize:this.props.pageSize,currentPage:this.props.currentPage,onPageChanged:this.onPageChanged,users:this.props.users,followingInProgress:this.props.followingInProgress,follow:this.props.follow,unfollow:this.props.unfollow})})}}]),n}(s.a.Component),Nt={setCurrentPage:ot,toggleIsFollowingProgress:lt,requestUsers:function(e,t){return function(){var n=Object(v.a)(x.a.mark((function n(r){var s;return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r(ut(!0)),r(ot(e)),n.next=4,w.getUsers(e,t);case 4:s=n.sent,r(ut(!1)),r((c=s.data.items,{type:et,users:c})),r((a=s.data.totalCount,{type:nt,count:a}));case 8:case"end":return n.stop()}var a,c}),n)})));return function(e){return n.apply(this,arguments)}}()},follow:function(e){return function(){var t=Object(v.a)(x.a.mark((function t(n){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:jt(n,e,w.follow.bind(w),ct);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},unfollow:function(e){return function(){var t=Object(v.a)(x.a.mark((function t(n){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:jt(n,e,w.unfollow.bind(w),it);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},Ct=Object(p.c)(Object(j.b)((function(e){return{users:pt(e),pageSize:ft(e),totalUsersCount:ht(e),currentPage:Ot(e),isFetching:gt(e),followingInProgress:mt(e)}}),Nt))(kt),It="app/INITIALIZED_SUCCESS",Et={initialized:!1},Ft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case It:return Object(g.a)(Object(g.a)({},e),{},{initialized:!0});default:return e}},Ut=n(108),Tt={},At=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tt;return e},Mt=n(117),Lt=Object(p.b)({profilePage:Ne,dialogsPage:Ut.a,sidebar:At,usersPage:bt,auth:G,app:Ft}),Dt=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||p.c,zt=Object(p.d)(Lt,Dt(Object(p.a)(Mt.a))),Rt=Object(r.lazy)((function(){return n.e(3).then(n.bind(null,258))})),Jt=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.initializeApp()}},{key:"render",value:function(){return this.props.initialized?Object(h.jsxs)("div",{className:"app-wrapper",children:[Object(h.jsx)(X,{}),Object(h.jsx)(de,{}),Object(h.jsx)("div",{className:"app-wrapper__content",children:Object(h.jsxs)(b.d,{children:[Object(h.jsx)(b.b,{exact:!0,path:"/",render:function(){return Object(h.jsx)(b.a,{to:"/profile"})}}),Object(h.jsx)(b.b,{path:"/profile/:userId?",render:function(){return Object(h.jsx)(Ke,{})}}),Object(h.jsx)(b.b,{path:"/dialogs/:dialogId?",render:(e=Rt,function(t){return Object(h.jsx)(r.Suspense,{fallback:Object(h.jsx)(O,{}),children:Object(h.jsx)(e,Object(g.a)({},t))})})}),Object(h.jsx)(b.b,{path:"/news",render:function(){return Object(h.jsx)(pe,{})}}),Object(h.jsx)(b.b,{path:"/music",render:function(){return Object(h.jsx)(le,{})}}),Object(h.jsx)(b.b,{path:"/users",render:function(){return Object(h.jsx)(Ct,{})}}),Object(h.jsx)(b.b,{path:"/settings",render:function(){return Object(h.jsx)(Ze,{})}}),Object(h.jsx)(b.b,{path:"/login",render:function(){return Object(h.jsx)(ue,{})}})]})})]}):Object(h.jsx)(O,{});var e}}]),n}(s.a.Component),Bt=Object(p.c)(b.g,Object(j.b)((function(e){return{initialized:e.app.initialized}}),{initializeApp:function(){return function(e){e(J()).then((function(){e({type:It})}))}}}))(Jt),Gt=function(){return Object(h.jsx)(d.a,{children:Object(h.jsx)(j.a,{store:zt,children:Object(h.jsx)(Bt,{})})})},Vt=(n(252),function(e){e&&e instanceof Function&&n.e(4).then(n.bind(null,257)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),s(e),a(e),c(e)}))});c.a.render(Object(h.jsx)(s.a.StrictMode,{children:Object(h.jsx)(Gt,{})}),document.getElementById("root")),Vt()},26:function(e,t,n){e.exports={heading:"ProfileData_heading__3qhzY",contacts__item:"ProfileData_contacts__item__i_Eiq",formSummaryError:"ProfileData_formSummaryError__1pWwY"}},29:function(e,t,n){e.exports={usersPage:"Users_usersPage__3xdAn",usersList:"Users_usersList__19LBE",user:"Users_user__1dQYj",userPhoto:"Users_userPhoto__17MJB",button:"Users_button__1saaY"}},39:function(e,t,n){e.exports={paginator:"Paginator_paginator__18P4_",page:"Paginator_page__2aOm1",selectedPage:"Paginator_selectedPage__3SIki"}},44:function(e,t,n){e.exports={loginForm:"LoginPage_loginForm__ZCg92",formSummaryError:"LoginPage_formSummaryError__P53oi"}},45:function(e,t,n){e.exports={header:"Header_header__1VCKf",logo:"Header_logo__3_SJs",loginBlock:"Header_loginBlock__6mma5",button:"Header_button__3kSo_"}},46:function(e,t,n){e.exports={posts:"MyPosts_posts__3tZ1c",textarea:"MyPosts_textarea__3KLbu",buttonWrapper:"MyPosts_buttonWrapper__koyn8"}},60:function(e,t,n){e.exports={error:"FormsControls_error__9lcue",inputError:"FormsControls_inputError__3a1p_"}},75:function(e,t,n){e.exports={item:"Post_item__ihtu9",post:"Post_post__A0EJd"}},76:function(e,t,n){e.exports={descriptionBlock:"ProfileInfo_descriptionBlock__3cd8Y",userInfo:"ProfileInfo_userInfo__3hlxg",userPhoto:"ProfileInfo_userPhoto__1UIR7"}}},[[253,1,2]]]);
//# sourceMappingURL=main.e7538679.chunk.js.map